# csgo-analysis

Analyze Counter-Strike: Global Offensive demos,
annotate tactics, and run graph neural network predictions.

`stats.py` and `ui\cli.py` are rather outdated.
The most recent version is `gui_app.py`.




## Installation

The suggested python version is `3.12.x`.

It is recommended to [create and activate a virtual environment](https://docs.python.org/3/tutorial/venv.html).

Requires awpy 1.3.1 @ https://github.com/pnxenopoulos/awpy/tree/f0bbee8a2b95d650210f34f70468f6b2457a6e4d

Due to broken dependencies in old awpy, install it in pip via argument `--no-deps`.

```bash
# add deadsnakes because of python3 versions
sudo add-apt-repository -y ppa:deadsnakes/ppa
sudo apt update
sudo apt install -y python3.12 python3.12-venv python3.12-dev python3.12-tk

git clone https://github.com/johuellm/csgo-analysis
cd csgo-analysis

python3.12 -m venv venv

venv/bin/pip install --upgrade pip
venv/bin/pip install -r requirements.txt
venv/bin/pip install --no-deps awpy==1.3.1
```



## Usage

### Graphical User Interface

Run the GUI.
```bash
# in csgo-analysis root folder
cp ".env.example" ".env"
PYTHONPATH=src/ venv/bin/python src/gui_app.py
```

### Downloading ESTA demos

To download ESTA demos automatically from the repository, you can use the `download_demo_from_repo.py`.

First, you create a json file with all the demo filenames, you want to download. For example:

```
[
	{ "filename": "00e7fec9-cee0-430f-80f4-6b50443ceacd.json" },
	{ "filename": "106ea5ff-48e6-4864-96f9-f8097bb1cc67.json" },
	{ "filename": "1993def5-6170-45ee-bd54-22a36c4a8129.json" },
	{ "filename": "1a8afefa-b15e-43cf-adb9-83446d956aaf.json" },
	{ "filename": "2a782dca-9cb4-45b6-a45f-ddc73d72ad77.json" },
	{ "filename": "3b9bead9-813b-4545-b2ad-4ebd24a36d4a.json" },
	{ "filename": "47fd068a-cb07-471d-a68d-e0ef52b70f91.json" },
	{ "filename": "5e84128e-561f-40d2-a85e-e702cf763791.json" },
	{ "filename": "9aa73173-d219-4c36-9e49-6924ca12e2ed.json" },
	{ "filename": "e67f0874-b013-4750-a244-49f0b48c0212.json" }
]
```

For `de_dust2`, we scouted all demos in the repository, available in `dust2_demos_filenames.json`.

Adjust the `.env` to set the json file and output folder.

The script tries both `lan`and `online` folders in the repository. Downloads are rather slow.

### Creating graph files

To create graph files, run the `create_graphs.py` Set `.env` file before. See commandline options with `create_graphy.py -h`.

### Summary of scripts

| File                               | What it does                                                                                                           |
|------------------------------------|------------------------------------------------------------------------------------------------------------------------|
| `create_graphs.py`                 | Parses demo files and creates graphs for each frame. Can be exported as `.pkl` or `.csv` files for further processing. |
| `gui_app.py`                       | Runs the GUI to view and annotate demo files with tactics.                                                             |
| `graphs_to.csv`                    | Converts existing graph `.pkl` files to a single `.csv` file.                                                          |
| `stats.py`                         | Generates a .csv file with various frame-level metrics. See [metrics](src/metrics/).                               |
| `utils/download_demo_from_repo.py` | Downloads all demos from the ESTA repository that are mentioned in `DUST2_DEMOS_FILENAMES_PATH` in the `.env` file.    |
| `utils/merge_csv.py`               | Merges all the `.csv` files generated by `create_graphs.py` into a single file.                                        |
| `utils/stats.py`                   | Generates descriptive statistics about the demos, downloaded, and annotated.                                           |